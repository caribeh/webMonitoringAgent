{
    "__inputs": [
      {
        "name": "DS_POSTGRESQL-METRICS",
        "label": "PostgreSQL-Metrics",
        "description": "",
        "type": "datasource",
        "pluginId": "postgres",
        "pluginName": "PostgreSQL"
      }
    ],
    "__requires": [
      {
        "type": "grafana",
        "id": "grafana",
        "name": "Grafana",
        "version": "10.0.0"
      },
      {
        "type": "datasource",
        "id": "postgres",
        "name": "PostgreSQL",
        "version": "1.0.0"
      }
    ],
    "annotations": {
      "list": [
        {
          "builtIn": 1,
          "datasource": {
            "type": "grafana",
            "uid": "-- Grafana --"
          },
          "enable": true,
          "hide": true,
          "iconColor": "rgba(0, 211, 255, 1)",
          "name": "Annotations & Alerts",
          "type": "dashboard"
        }
      ]
    },
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 0,
    "links": [],
    "liveNow": false,
    "panels": [
      {
        "id": 1,
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 0 },
        "type": "timeseries",
        "title": "Latência Média (Ping RTT)",
        "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
        "targets": [
          {
            "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": true,
            "refId": "A",
            "select": [ [ { "type": "column", "params": ["rtt_avg_ms"] } ] ],
            "table": "ping_metrics",
            "timeColumn": "timestamp",
            "where": [ { "name": "$__timeFilter", "params": [], "type": "macro" }, { "datatype": "varchar", "name": "", "params": ["target", "IN", "$target"], "type": "expression" } ],
            "rawSql": "SELECT\n  timestamp AS \"time\",\n  rtt_avg_ms,\n  target\nFROM ping_metrics\nWHERE\n  $__timeFilter(timestamp) AND\n  target IN ($target)\nORDER BY 1"
          }
        ],
        "fieldConfig": {
          "defaults": { "unit": "ms" },
          "overrides": []
        }
      },
      {
        "id": 2,
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 0 },
        "type": "timeseries",
        "title": "Perda de Pacotes",
        "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
        "targets": [
          {
            "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": true,
            "refId": "A",
            "select": [ [ { "type": "column", "params": ["packet_loss_percent"] } ] ],
            "table": "ping_metrics",
            "timeColumn": "timestamp",
            "where": [ { "name": "$__timeFilter", "params": [], "type": "macro" }, { "datatype": "varchar", "name": "", "params": ["target", "IN", "$target"], "type": "expression" } ],
            "rawSql": "SELECT\n  timestamp AS \"time\",\n  packet_loss_percent,\n  target\nFROM ping_metrics\nWHERE\n  $__timeFilter(timestamp) AND\n  target IN ($target)\nORDER BY 1"
          }
        ],
        "fieldConfig": {
          "defaults": { "unit": "percent" },
          "overrides": []
        }
      },
      {
        "id": 3,
        "gridPos": { "h": 8, "w": 24, "x": 0, "y": 8 },
        "type": "timeseries",
        "title": "Tempo de Carregamento Web",
        "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
        "targets": [
          {
            "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": true,
            "refId": "A",
            "select": [ [ { "type": "column", "params": ["load_time_ms"] } ] ],
            "table": "web_metrics",
            "timeColumn": "timestamp",
            "where": [ { "name": "$__timeFilter", "params": [], "type": "macro" }, { "datatype": "varchar", "name": "", "params": ["url", "LIKE", "'%://' || $target"], "type": "expression" } ],
            "rawSql": "SELECT\n  timestamp AS \"time\",\n  load_time_ms,\n  url\nFROM web_metrics\nWHERE\n  $__timeFilter(timestamp) AND\n  url LIKE ('%://' || $target)\nORDER BY 1"
          }
        ],
        "fieldConfig": {
          "defaults": { "unit": "ms" },
          "overrides": []
        }
      },
      {
        "id": 4,
        "gridPos": { "h": 8, "w": 24, "x": 0, "y": 16 },
        "type": "barchart",
        "title": "Contagem de Status Code HTTP",
        "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
        "targets": [
          {
            "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
            "format": "table",
            "group": [],
            "metricColumn": "none",
            "rawQuery": true,
            "refId": "A",
            "select": [ [ { "type": "column", "params": ["status_code"] } ] ],
            "table": "web_metrics",
            "timeColumn": "timestamp",
            "where": [ { "name": "$__timeFilter", "params": [], "type": "macro" }, { "datatype": "varchar", "name": "", "params": ["url", "LIKE", "'%://' || $target"], "type": "expression" } ],
            "rawSql": "SELECT\n  CAST(status_code AS TEXT) as status, \n  COUNT(*) as count \nFROM web_metrics\nWHERE\n  $__timeFilter(timestamp) AND\n  url LIKE ('%://' || $target)\nGROUP BY status\nORDER BY status"
          }
        ]
      }
    ],
    "refresh": "1m",
    "schemaVersion": 37,
    "style": "dark",
    "tags": [],
    "templating": {
      "list": [
        {
          "allValue": null,
          "current": {},
          "datasource": { "type": "postgres", "uid": "${DS_POSTGRESQL-METRICS}" },
          "definition": "SELECT DISTINCT target FROM ping_metrics",
          "hide": 0,
          "includeAll": true,
          "multi": true,
          "name": "target",
          "options": [],
          "query": "SELECT DISTINCT target FROM ping_metrics",
          "refresh": 1,
          "regex": "",
          "skipUrlSync": false,
          "sort": 1,
          "type": "query"
        }
      ]
    },
    "time": { "from": "now-1h", "to": "now" },
    "timepicker": {},
    "timezone": "browser",
    "title": "Web & Network Monitoring",
    "uid": "my-unique-dashboard-id-01",
    "version": 1,
    "weekStart": ""
  }